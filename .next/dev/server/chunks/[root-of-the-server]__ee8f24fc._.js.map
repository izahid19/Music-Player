{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///D:/project/music-player/Music-Player/src/lib/mongodb.ts"],"sourcesContent":["import mongoose from 'mongoose';\r\n\r\ndeclare global {\r\n  var mongoose: {\r\n    conn: mongoose.Connection | null;\r\n    promise: Promise<mongoose.Connection> | null;\r\n  };\r\n}\r\n\r\nconst MONGODB_URI = process.env.MONGODB_URI!;\r\n\r\nif (!MONGODB_URI) {\r\n  throw new Error('Please define the MONGODB_URI environment variable inside .env.local');\r\n}\r\n\r\nlet cached = global.mongoose;\r\n\r\nif (!cached) {\r\n  cached = global.mongoose = { conn: null, promise: null };\r\n}\r\n\r\nasync function dbConnect(): Promise<mongoose.Connection> {\r\n  if (cached.conn) {\r\n    return cached.conn;\r\n  }\r\n\r\n  if (!cached.promise) {\r\n    const opts = {\r\n      bufferCommands: false,\r\n    };\r\n\r\n    cached.promise = mongoose.connect(MONGODB_URI, opts).then((mongoose) => {\r\n      return mongoose.connection;\r\n    });\r\n  }\r\n\r\n  try {\r\n    cached.conn = await cached.promise;\r\n  } catch (e) {\r\n    cached.promise = null;\r\n    throw e;\r\n  }\r\n\r\n  return cached.conn;\r\n}\r\n\r\nexport default dbConnect;\r\n"],"names":[],"mappings":";;;;AAAA;;AASA,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW;AAE3C,IAAI,CAAC,aAAa;IAChB,MAAM,IAAI,MAAM;AAClB;AAEA,IAAI,SAAS,OAAO,QAAQ;AAE5B,IAAI,CAAC,QAAQ;IACX,SAAS,OAAO,QAAQ,GAAG;QAAE,MAAM;QAAM,SAAS;IAAK;AACzD;AAEA,eAAe;IACb,IAAI,OAAO,IAAI,EAAE;QACf,OAAO,OAAO,IAAI;IACpB;IAEA,IAAI,CAAC,OAAO,OAAO,EAAE;QACnB,MAAM,OAAO;YACX,gBAAgB;QAClB;QAEA,OAAO,OAAO,GAAG,oHAAQ,CAAC,OAAO,CAAC,aAAa,MAAM,IAAI,CAAC,CAAC;YACzD,OAAO,SAAS,UAAU;QAC5B;IACF;IAEA,IAAI;QACF,OAAO,IAAI,GAAG,MAAM,OAAO,OAAO;IACpC,EAAE,OAAO,GAAG;QACV,OAAO,OAAO,GAAG;QACjB,MAAM;IACR;IAEA,OAAO,OAAO,IAAI;AACpB;uCAEe"}},
    {"offset": {"line": 94, "column": 0}, "map": {"version":3,"sources":["file:///D:/project/music-player/Music-Player/src/models/Song.ts"],"sourcesContent":["import mongoose, { Schema, Document, Model } from 'mongoose';\r\n\r\nexport interface ISong extends Document {\r\n  name: string;\r\n  artist: string;\r\n  cover: string;\r\n  audio: string;\r\n  color: [string, string];\r\n  active: boolean;\r\n  createdAt: Date;\r\n  updatedAt: Date;\r\n}\r\n\r\nconst SongSchema = new Schema<ISong>(\r\n  {\r\n    name: {\r\n      type: String,\r\n      required: [true, 'Song name is required'],\r\n      trim: true,\r\n    },\r\n    artist: {\r\n      type: String,\r\n      required: [true, 'Artist name is required'],\r\n      trim: true,\r\n    },\r\n    cover: {\r\n      type: String,\r\n      required: [true, 'Cover image URL is required'],\r\n    },\r\n    audio: {\r\n      type: String,\r\n      required: [true, 'Audio URL is required'],\r\n    },\r\n    color: {\r\n      type: [String],\r\n      required: true,\r\n      validate: {\r\n        validator: (v: string[]) => v.length === 2,\r\n        message: 'Color must have exactly 2 values (primary and secondary)',\r\n      },\r\n    },\r\n    active: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n  },\r\n  {\r\n    timestamps: true,\r\n  }\r\n);\r\n\r\nconst Song: Model<ISong> = mongoose.models.Song || mongoose.model<ISong>('Song', SongSchema);\r\n\r\nexport default Song;\r\n"],"names":[],"mappings":";;;;AAAA;;AAaA,MAAM,aAAa,IAAI,mHAAM,CAC3B;IACE,MAAM;QACJ,MAAM;QACN,UAAU;YAAC;YAAM;SAAwB;QACzC,MAAM;IACR;IACA,QAAQ;QACN,MAAM;QACN,UAAU;YAAC;YAAM;SAA0B;QAC3C,MAAM;IACR;IACA,OAAO;QACL,MAAM;QACN,UAAU;YAAC;YAAM;SAA8B;IACjD;IACA,OAAO;QACL,MAAM;QACN,UAAU;YAAC;YAAM;SAAwB;IAC3C;IACA,OAAO;QACL,MAAM;YAAC;SAAO;QACd,UAAU;QACV,UAAU;YACR,WAAW,CAAC,IAAgB,EAAE,MAAM,KAAK;YACzC,SAAS;QACX;IACF;IACA,QAAQ;QACN,MAAM;QACN,SAAS;IACX;AACF,GACA;IACE,YAAY;AACd;AAGF,MAAM,OAAqB,oHAAQ,CAAC,MAAM,CAAC,IAAI,IAAI,oHAAQ,CAAC,KAAK,CAAQ,QAAQ;uCAElE"}},
    {"offset": {"line": 178, "column": 0}, "map": {"version":3,"sources":["file:///D:/project/music-player/Music-Player/src/lib/auth.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport jwt from 'jsonwebtoken';\r\n\r\nconst JWT_SECRET = process.env.JWT_SECRET!;\r\n\r\nexport function verifyAdminToken(request: NextRequest): { valid: boolean; email?: string } {\r\n  const token = request.cookies.get('admin_token')?.value;\r\n\r\n  if (!token) {\r\n    return { valid: false };\r\n  }\r\n\r\n  try {\r\n    const decoded = jwt.verify(token, JWT_SECRET) as { email: string; role: string };\r\n    if (decoded.role === 'admin') {\r\n      return { valid: true, email: decoded.email };\r\n    }\r\n    return { valid: false };\r\n  } catch {\r\n    return { valid: false };\r\n  }\r\n}\r\n\r\nexport function unauthorizedResponse() {\r\n  return NextResponse.json(\r\n    { error: 'Unauthorized' },\r\n    { status: 401 }\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU;AAElC,SAAS,iBAAiB,OAAoB;IACnD,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC,gBAAgB;IAElD,IAAI,CAAC,OAAO;QACV,OAAO;YAAE,OAAO;QAAM;IACxB;IAEA,IAAI;QACF,MAAM,UAAU,2MAAG,CAAC,MAAM,CAAC,OAAO;QAClC,IAAI,QAAQ,IAAI,KAAK,SAAS;YAC5B,OAAO;gBAAE,OAAO;gBAAM,OAAO,QAAQ,KAAK;YAAC;QAC7C;QACA,OAAO;YAAE,OAAO;QAAM;IACxB,EAAE,OAAM;QACN,OAAO;YAAE,OAAO;QAAM;IACxB;AACF;AAEO,SAAS;IACd,OAAO,+PAAY,CAAC,IAAI,CACtB;QAAE,OAAO;IAAe,GACxB;QAAE,QAAQ;IAAI;AAElB"}},
    {"offset": {"line": 224, "column": 0}, "map": {"version":3,"sources":["file:///D:/project/music-player/Music-Player/src/app/api/songs/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport dbConnect from '@/lib/mongodb';\r\nimport Song from '@/models/Song';\r\nimport { verifyAdminToken, unauthorizedResponse } from '@/lib/auth';\r\n\r\n// GET songs with pagination and search (public)\r\nexport async function GET(request: NextRequest) {\r\n  try {\r\n    await dbConnect();\r\n\r\n    // Get query parameters\r\n    const { searchParams } = new URL(request.url);\r\n    const fetchAll = searchParams.get('all') === 'true';\r\n    const page = parseInt(searchParams.get('page') || '1');\r\n    const limit = parseInt(searchParams.get('limit') || '10');\r\n    const search = searchParams.get('search') || '';\r\n\r\n    // Build search query\r\n    const searchQuery = search\r\n      ? {\r\n          $or: [\r\n            { name: { $regex: search, $options: 'i' } },\r\n            { artist: { $regex: search, $options: 'i' } },\r\n          ],\r\n        }\r\n      : {};\r\n\r\n    // If fetchAll is true, return all songs without pagination\r\n    if (fetchAll) {\r\n      const songs = await Song.find(searchQuery).sort({ createdAt: -1 });\r\n      \r\n      const formattedSongs = songs.map((song, index) => ({\r\n        id: song._id.toString(),\r\n        name: song.name,\r\n        artist: song.artist,\r\n        cover: song.cover,\r\n        audio: song.audio,\r\n        color: song.color,\r\n        active: index === 0,\r\n      }));\r\n\r\n      return NextResponse.json(formattedSongs);\r\n    }\r\n\r\n    // Get total count for pagination\r\n    const total = await Song.countDocuments(searchQuery);\r\n\r\n    // Get paginated songs\r\n    const songs = await Song.find(searchQuery)\r\n      .sort({ createdAt: -1 })\r\n      .skip((page - 1) * limit)\r\n      .limit(limit);\r\n\r\n    // Transform to match the expected format\r\n    const formattedSongs = songs.map((song, index) => ({\r\n      id: song._id.toString(),\r\n      name: song.name,\r\n      artist: song.artist,\r\n      cover: song.cover,\r\n      audio: song.audio,\r\n      color: song.color,\r\n      active: page === 1 && index === 0,\r\n    }));\r\n\r\n    return NextResponse.json({\r\n      songs: formattedSongs,\r\n      pagination: {\r\n        page,\r\n        limit,\r\n        total,\r\n        totalPages: Math.ceil(total / limit),\r\n      },\r\n    });\r\n  } catch (error) {\r\n    console.error('Get songs error:', error);\r\n    return NextResponse.json(\r\n      { error: 'Failed to fetch songs' },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n\r\n// POST new song (protected)\r\nexport async function POST(request: NextRequest) {\r\n  const auth = verifyAdminToken(request);\r\n  if (!auth.valid) {\r\n    return unauthorizedResponse();\r\n  }\r\n\r\n  try {\r\n    const body = await request.json();\r\n    const { name, artist, cover, audio, color } = body;\r\n\r\n    if (!name || !artist || !cover || !audio || !color) {\r\n      return NextResponse.json(\r\n        { error: 'All fields are required' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    await dbConnect();\r\n\r\n    const song = await Song.create({\r\n      name,\r\n      artist,\r\n      cover,\r\n      audio,\r\n      color,\r\n      active: false,\r\n    });\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      song: {\r\n        id: song._id.toString(),\r\n        name: song.name,\r\n        artist: song.artist,\r\n        cover: song.cover,\r\n        audio: song.audio,\r\n        color: song.color,\r\n        active: song.active,\r\n      },\r\n    });\r\n  } catch (error) {\r\n    console.error('Create song error:', error);\r\n    return NextResponse.json(\r\n      { error: 'Failed to create song' },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}}]
}
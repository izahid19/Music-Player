{"version":3,"sources":["../../../src/lib/auth.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport jwt from 'jsonwebtoken';\r\n\r\nconst JWT_SECRET = process.env.JWT_SECRET!;\r\n\r\nexport function verifyAdminToken(request: NextRequest): { valid: boolean; email?: string } {\r\n  const token = request.cookies.get('admin_token')?.value;\r\n\r\n  if (!token) {\r\n    return { valid: false };\r\n  }\r\n\r\n  try {\r\n    const decoded = jwt.verify(token, JWT_SECRET) as { email: string; role: string };\r\n    if (decoded.role === 'admin') {\r\n      return { valid: true, email: decoded.email };\r\n    }\r\n    return { valid: false };\r\n  } catch {\r\n    return { valid: false };\r\n  }\r\n}\r\n\r\nexport function unauthorizedResponse() {\r\n  return NextResponse.json(\r\n    { error: 'Unauthorized' },\r\n    { status: 401 }\r\n  );\r\n}\r\n"],"names":[],"mappings":"ymCAAA,IAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,MAEA,IAAM,EAAa,QAAQ,GAAG,CAAC,UAAU,CAElC,SAAS,EAAiB,CAAoB,EACnD,IAAM,EAAQ,EAAQ,OAAO,CAAC,GAAG,CAAC,gBAAgB,MAElD,GAAI,CAAC,EACH,KADU,CACH,CAAE,OAAO,CAAM,EAGxB,GAAI,CACF,IAAM,EAAU,EAAA,OAAG,CAAC,MAAM,CAAC,EAAO,GAClC,GAAqB,SAAS,CAA1B,EAAQ,IAAI,CACd,MAAO,CAAE,MAAO,GAAM,MAAO,EAAQ,KAAK,AAAC,EAE7C,MAAO,CAAE,OAAO,CAAM,CACxB,CAAE,KAAM,CACN,MAAO,CAAE,OAAO,CAAM,CACxB,CACF,CAEO,SAAS,IACd,OAAO,EAAA,YAAY,CAAC,IAAI,CACtB,CAAE,MAAO,cAAe,EACxB,CAAE,OAAQ,GAAI,EAElB"}